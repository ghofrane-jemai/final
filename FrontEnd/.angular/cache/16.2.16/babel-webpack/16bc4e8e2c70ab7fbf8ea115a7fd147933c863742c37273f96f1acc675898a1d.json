{"ast":null,"code":"import _asyncToGenerator from \"D:/3emeISAMM/PFE/Code/user-form/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nimport * as i2 from \"@angular/common\";\nimport * as i3 from \"@angular/forms\";\nconst _c0 = [\"lastNameInput\"];\nconst _c1 = [\"videoElement\"];\nconst _c2 = [\"canvasElement\"];\nfunction HomeComponent_option_25_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 31);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const country_r12 = ctx.$implicit;\n    i0.ɵɵproperty(\"value\", country_r12);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(country_r12);\n  }\n}\nfunction HomeComponent_option_31_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 31);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const city_r13 = ctx.$implicit;\n    i0.ɵɵproperty(\"value\", city_r13);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(city_r13);\n  }\n}\nfunction HomeComponent_div_37_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 32);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r6 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(ctx_r6.ageError);\n  }\n}\nfunction HomeComponent_div_38_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 32);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r7 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(ctx_r7.dateError);\n  }\n}\nfunction HomeComponent_div_44_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\")(1, \"strong\");\n    i0.ɵɵtext(2, \"Selfie v\\u00E9rifi\\u00E9e:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(3, \"img\", 33);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r8 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"src\", ctx_r8.user.selfie, i0.ɵɵsanitizeUrl);\n  }\n}\nfunction HomeComponent_div_49_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\")(1, \"strong\");\n    i0.ɵɵtext(2, \"R\\u00E9sultats extract\\u00E9s (Recto) :\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"pre\");\n    i0.ɵɵtext(4);\n    i0.ɵɵpipe(5, \"json\");\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r9 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(5, 1, ctx_r9.user.extractedDataFront));\n  }\n}\nfunction HomeComponent_div_54_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\")(1, \"strong\");\n    i0.ɵɵtext(2, \"R\\u00E9sultats extract\\u00E9s (Verso) :\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"pre\");\n    i0.ɵɵtext(4);\n    i0.ɵɵpipe(5, \"json\");\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r10 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(5, 1, ctx_r10.user.extractedDataBack));\n  }\n}\nvar UserFields;\n(function (UserFields) {\n  UserFields[\"FirstName\"] = \"firstName\";\n  UserFields[\"LastName\"] = \"lastName\";\n  UserFields[\"Country\"] = \"country\";\n  UserFields[\"City\"] = \"city\";\n  UserFields[\"Dob\"] = \"dob\";\n  UserFields[\"Gender\"] = \"gender\";\n  UserFields[\"IdCardFront\"] = \"idCardFront\";\n  UserFields[\"IdCardBack\"] = \"idCardBack\";\n  UserFields[\"Selfie\"] = \"selfie\";\n})(UserFields || (UserFields = {}));\nexport class HomeComponent {\n  constructor(http) {\n    this.http = http;\n    this.UserFields = UserFields; // Exposer l'énumération\n    this.lastNameInput = null; // Référence pour le champ lastName\n    this.videoElement = null;\n    this.canvasElement = null;\n    this.user = {\n      firstName: '',\n      lastName: '',\n      country: '',\n      city: '',\n      dob: '',\n      dobArabic: '',\n      gender: '',\n      genderArabic: '',\n      idCardFront: '',\n      idCardBack: '',\n      extractedDataFront: {},\n      extractedDataBack: {},\n      selfie: ''\n    };\n    this.ageError = '';\n    this.dateError = '';\n    this.countries = [\"Tunisie\"];\n    this.citiesByCountry = {\n      \"Tunisie\": [\"Nabeul\", \"Qurbus\", \"Kélibia\", \"Yasmine Hammamet\", \"Kerkouane\", \"Al Huwariyah\", \"Kairouan\", \"Douz\", \"Nefta\", \"Ksar Ghilane\", \"Gafsa\", \"Degueche\", \"Shabikah\", \"Tozeur\", \"Bizerte\", \"Takrouna\", \"Djebba\", \"Midoun\", \"Djerba Ajim\", \"Ghizen\", \"Arkou\", \"Houmt Souk\", \"Aghir\", \"Hara Sghira Er Riadh\", \"Mellita\", \"Souk Houmet\", \"Mezraia\", \"Djerba Midun\", \"Ksar Hadada\", \"Tataouine Nord\", \"Tataouine Ville\", \"Ghomrassen\", \"Testour\", \"Kesra\", \"Beja, Tunisie\", \"Le Kef\", \"Makthar\", \"Sabria\", \"Toujane\", \"Zaghouan\", \"Zriba\", \"Matmata\", \"Gabès Médina\", \"Tamezret\", \"La Marsa\", \"La Goulette\", \"Tunis\", \"Carthage\", \"Sidi Bou Saïd\", \"Sbeïtla\", \"Monastir\", \"Sahline\", \"Ariana, Tunisie\", \"CHENINI\", \"Douiret\", \"Bani Khedeche\", \"Ksar Ouled Brahim\", \"Sangho\", \"Médine\", \"Mahboubine\", \"Khalfallah\", \"Ksar Hallouf\", \"Zarzis\", \"Guellala\", \"Hammam Sousse\", \"Hammamet\", \"Sousse\", \"M'saken\", \"El Jem\", \"Hiboun\", \"Mahdia\"]\n    };\n    this.cities = [];\n    this.selectedVersoImage = null;\n    this.selectedVersoImageHash = null;\n    this.isSubmitting = false;\n    this.previousFirstname = '';\n    this.previousLastname = '';\n  }\n  ngOnInit() {\n    const video = document.getElementById('videoElement');\n    navigator.mediaDevices.getUserMedia({\n      video: true\n    }).then(stream => {\n      video.srcObject = stream;\n    }).catch(error => {\n      console.error(\"Erreur lors de l'accès à la caméra : \", error);\n    });\n  }\n  onFileChangeRecto(event, field) {\n    const input = event.target;\n    if (input.files && input.files.length > 0) {\n      const file = input.files[0];\n      // Appeler le serveur pour traiter l'image\n      const formData = new FormData();\n      formData.append('image', file);\n      this.http.post('http://localhost:5001/ocr/recto', formData).subscribe(response => {\n        console.log('Résultat OCR Recto:', response);\n        // Stocker le genre en arabe\n        this.user.gender = response.genre === 'male' ? 'ذكر' : 'أنثى';\n        if (response.error) {\n          alert('Erreur : ' + response.message);\n          return;\n        }\n        this.getBase64Image(file).then(base64 => {\n          this.user.idCardFront = base64;\n        });\n        this.user.extractedDataFront = response.donnees;\n        // Envoyer les données à comparaison_N_P.py\n        const ocrData = {\n          'ocr_result': this.user.extractedDataFront,\n          'genre': this.user.gender // Envoyer le genre au serveur\n        };\n\n        this.http.post('http://localhost:5003/ocr-extraction', ocrData).subscribe(response => {\n          console.log(`Résultats d'extraction OCR envoyés au serveur Python :`, response);\n        }, error => {\n          console.error('Erreur lors de l\\'envoi des données à comparaison_N_P.py (OCR Recto):', error);\n        });\n        if (this.selectedVersoImage) {\n          this.processVersoImage(this.selectedVersoImage);\n        }\n      }, error => {\n        console.error('Erreur lors du traitement OCR Recto :', error);\n      });\n    }\n  }\n  processVersoImage(image) {\n    // Nettoyer les données précédentes du Verso\n    this.user.idCardBack = null;\n    this.user.extractedDataBack = {};\n    const formData = new FormData();\n    formData.append('image', image);\n    this.http.post('http://localhost:5002/ocr/verso', formData).subscribe(response => {\n      console.log('Résultat OCR Verso:', response);\n      if (response.message === \"Conditions non remplies\") {\n        alert(\"Erreur : L'image Verso sélectionnée ne correspond pas aux critères attendus.\");\n        return;\n      }\n      this.getBase64Image(image).then(base64 => {\n        this.user.idCardBack = base64;\n      });\n      this.user.extractedDataBack = response.donnees; // Stocker les résultats extractés\n    }, error => {\n      console.error('Erreur lors du traitement OCR Verso:', error);\n    });\n  }\n  onFileChangeVerso(event, field) {\n    const input = event.target;\n    if (input.files && input.files.length > 0) {\n      this.selectedVersoImage = input.files[0]; // Stocker l'image Verso\n      this.selectedVersoImageHash = this.selectedVersoImage.name + this.selectedVersoImage.lastModified;\n      const file = input.files[0];\n      // Appeler le serveur pour traiter l'image\n      const formData = new FormData();\n      formData.append('image', file);\n      this.http.post('http://localhost:5002/ocr/verso', formData).subscribe(response => {\n        console.log('Résultat OCR Verso:', response);\n        if (response.message === \"Conditions non remplies\") {\n          alert(\"Erreur : L'image Verso sélectionnée ne correspond pas aux critères attendus.\");\n          return;\n        }\n        this.getBase64Image(file).then(base64 => {\n          this.user.idCardBack = base64;\n        });\n        this.user.extractedDataBack = response.donnees; // Stocker les résultats extractés\n      }, error => {\n        console.error('Erreur lors du traitement OCR Verso:', error);\n      });\n    }\n  }\n  // Nouvelle méthode pour convertir l'image en base64\n  getBase64Image(file) {\n    const reader = new FileReader();\n    reader.readAsDataURL(file);\n    return new Promise(resolve => {\n      reader.onload = () => resolve(reader.result);\n    });\n  }\n  validateForm() {\n    return this.user.firstName !== '' && this.user.lastName !== '' && this.user.country !== '' && this.user.city !== '' && this.user.dob !== '' && this.user.gender !== '' && this.user.idCardFront !== null && this.user.idCardBack !== null && this.user.selfie !== null;\n  }\n  startLivenessDetection() {\n    var _this = this;\n    return _asyncToGenerator(function* () {\n      // Arrêter la caméra simple si elle est en cours\n      _this.stopCamera();\n      try {\n        // Spécifiez le type de réponse attendu\n        const response = yield _this.http.post('http://localhost:5004/start-liveness-detection', {}).toPromise();\n        // Vérifiez que la réponse existe\n        if (!response) {\n          throw new Error('Aucune réponse du serveur de détection de vivacité');\n        }\n        if (response.success) {\n          // Si la détection réussit, récupérer l'image finale\n          _this.http.get('http://localhost:5004/get-liveness-result', {\n            responseType: 'blob'\n          }).subscribe(blob => {\n            const reader = new FileReader();\n            reader.onload = () => {\n              _this.user.selfie = reader.result;\n            };\n            reader.readAsDataURL(blob);\n          }, error => {\n            console.error(\"Erreur lors de la récupération de l'image:\", error);\n            alert(\"Erreur lors de la récupération de l'image de vérification\");\n          });\n        } else {\n          alert(\"Échec de la vérification de vivacité: \" + (response.message || 'Raison inconnue'));\n        }\n      } catch (error) {\n        console.error(\"Erreur lors de la détection de vivacité:\", error);\n        alert(\"Erreur lors de la vérification de vivacité\");\n      }\n    })();\n  }\n  restartCamera() {\n    if (this.videoElement?.nativeElement) {\n      const stream = this.videoElement.nativeElement.srcObject;\n      if (stream) {\n        stream.getTracks().forEach(track => track.stop());\n      }\n    }\n    setTimeout(() => {\n      this.startCamera();\n    }, 500);\n  }\n  onCountryChange() {\n    const selectedCountry = this.user.country;\n    this.cities = this.citiesByCountry[selectedCountry] || [];\n    this.user.city = '';\n  }\n  convertDateToArabic(dateStr) {\n    return new Promise((resolve, reject) => {\n      if (!dateStr) {\n        resolve('');\n        return;\n      }\n      const parts = dateStr.split('/');\n      if (parts.length !== 3) {\n        resolve(dateStr); // Retourne la date originale si le format est incorrect\n        return;\n      }\n      const day = parts[0];\n      const month = parts[1];\n      const year = parts[2];\n      const monthNames = ['جانفي', 'فيفري', 'مارس', 'أفريل', 'ماي', 'جوان', 'جويلية', 'أوت', 'سبتمبر', 'أكتوبر', 'نوفمبر', 'ديسمبر'];\n      const monthIndex = parseInt(month, 10) - 1;\n      if (monthIndex < 0 || monthIndex >= 12) {\n        resolve(dateStr); // Retourne la date originale si le mois est invalide\n        return;\n      }\n      const arabicDate = `${day} ${monthNames[monthIndex]} ${year}`;\n      resolve(arabicDate);\n    });\n  }\n  onDateChange() {\n    const birthdate = new Date(this.user.dob);\n    const today = new Date();\n    if (birthdate.getFullYear() > today.getFullYear()) {\n      this.dateError = \"Choix incorrect : l'année choisie ne peut pas être supérieure à l'année actuelle.\";\n      this.ageError = \"\";\n      return;\n    } else {\n      this.dateError = \"\";\n    }\n    const age = today.getFullYear() - birthdate.getFullYear();\n    const monthDiff = today.getMonth() - birthdate.getMonth();\n    if (age < 18 || age === 18 && monthDiff < 0) {\n      this.ageError = \"Vous devez avoir au moins 18 ans.\";\n    } else {\n      this.ageError = \"\";\n    }\n    // Convertir la date en format arabe et l'envoyer au serveur\n    const formattedDate = this.formatDate(this.user.dob);\n    this.convertDateToArabic(formattedDate).then(arabicDate => {\n      this.user.dobArabic = arabicDate;\n      console.log('Date transformée en arabe:', this.user.dobArabic);\n      // Envoyer la date au serveur\n      this.sendTransliteratedDate(arabicDate);\n    }).catch(error => {\n      console.error('Erreur lors de la conversion de la date:', error);\n    });\n  }\n  sendTransliteratedDate(arabicDate) {\n    const apiUrl = 'http://localhost:5003/transliterate-names';\n    const data = {\n      'تاريخ الولادة': arabicDate\n    };\n    this.http.post(apiUrl, data, {\n      headers: {\n        'Content-Type': 'application/json'\n      }\n    }).subscribe(response => {\n      console.log('Date en arabe envoyée avec succès:', response);\n    }, error => {\n      console.error('Erreur lors de l\\'envoi de la date:', error);\n    });\n  }\n  onGenderChange(genre) {\n    this.user.genderArabic = genre; // Mettre à jour le genre dans l'objet user\n    console.log('Genre sélectionné:', this.user.genderArabic);\n    // Envoyer le genre au serveur\n    this.sendTransliteratedGender(genre);\n  }\n  sendTransliteratedGender(genre) {\n    const apiUrl = 'http://localhost:5003/transliterate-names';\n    // Convertir le genre en arabe\n    const genderArabic = genre === 'male' ? 'ذكر' : 'أنثى';\n    const data = {\n      'الجنس': genderArabic // Utiliser le genre en arabe\n    };\n\n    this.http.post(apiUrl, data, {\n      headers: {\n        'Content-Type': 'application/json'\n      }\n    }).subscribe(response => {\n      console.log('Genre en arabe envoyé avec succès:', response);\n    }, error => {\n      console.error('Erreur lors de l\\'envoi du genre:', error);\n    });\n  }\n  startCamera() {\n    const video = document.getElementById('videoElement');\n    if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {\n      navigator.mediaDevices.getUserMedia({\n        video: true\n      }).then(stream => {\n        video.srcObject = stream;\n        video.style.display = \"block\"; // Rendre la vidéo visible\n      }).catch(error => {\n        console.error(\"Erreur d'accès à la caméra :\", error);\n      });\n    }\n  }\n  stopCamera() {\n    const video = document.getElementById('videoElement');\n    const stream = video.srcObject;\n    if (stream) {\n      const tracks = stream.getTracks();\n      tracks.forEach(track => track.stop()); // Arrêter la caméra\n      video.srcObject = null;\n      video.style.display = \"none\"; // Cacher la vidéo\n    }\n  }\n\n  checkFocusOutFirstName(event) {\n    const firstname = event.target.value.trim();\n    if (firstname !== '' && firstname !== this.previousFirstname) {\n      this.sendTransliteratedName('firstName', firstname);\n      this.previousFirstname = firstname;\n    }\n  }\n  checkFocusOutLastName(event) {\n    const lastname = event.target.value.trim();\n    if (lastname !== '' && lastname !== this.previousLastname) {\n      this.sendTransliteratedName('lastName', lastname);\n      this.previousLastname = lastname;\n    }\n  }\n  sendTransliteratedName(field, value) {\n    const apiUrl = 'http://localhost:5000/transliterate';\n    const data = {\n      [field === 'firstName' ? 'firstName' : 'lastName']: value\n    };\n    this.http.post(apiUrl, data, {\n      headers: {\n        'Content-Type': 'application/json'\n      }\n    }).subscribe(response => {\n      const transliteratedName = field === 'firstName' ? response['الاسم'] : response['اللقب'];\n      console.log(`${field} translittéré : ${transliteratedName}`);\n      // Envoyer le résultat au serveur Python\n      const sendData = {\n        [field === 'firstName' ? 'الاسم' : 'اللقب']: transliteratedName\n      };\n      this.http.post('http://localhost:5003/transliterate-names', sendData, {\n        headers: {\n          'Content-Type': 'application/json'\n        }\n      }).subscribe(sendResponse => {\n        console.log(`${field} envoyé au serveur Python avec succès`);\n      }, sendError => {\n        console.error(`Erreur lors de l'envoi de ${field} au serveur Python :`, sendError);\n      });\n    }, error => {\n      console.error(`Erreur lors de la translittération de ${field} :`, error);\n    });\n  }\n  transliterateFirstName() {\n    if (this.user.firstName.trim() !== '') {\n      const apiUrl = 'http://localhost:5000/transliterate';\n      const data = {\n        firstName: this.user.firstName\n      };\n      this.http.post(apiUrl, data, {\n        headers: {\n          'Content-Type': 'application/json'\n        }\n      }).subscribe(response => {\n        console.log(`Prénom translittéré : ${response['الاسم']}`);\n        // Traitement supplémentaire si nécessaire\n      }, error => {\n        console.error('Erreur lors de la translittération du prénom :', error);\n      });\n    }\n  }\n  transliterateLastName() {\n    if (this.user.lastName.trim() !== '') {\n      const apiUrl = 'http://localhost:5000/transliterate';\n      const data = {\n        lastName: this.user.lastName\n      };\n      this.http.post(apiUrl, data, {\n        headers: {\n          'Content-Type': 'application/json'\n        }\n      }).subscribe(response => {\n        console.log(`Nom translittéré : ${response['اللقب']}`);\n        // Traitement supplémentaire si nécessaire\n      }, error => {\n        console.error('Erreur lors de la translittération du nom :', error);\n      });\n    }\n  }\n  onSubmit() {\n    var _this2 = this;\n    return _asyncToGenerator(function* () {\n      if (_this2.isSubmitting) return;\n      _this2.isSubmitting = true;\n      // Validation des champs obligatoires\n      if (!_this2.validateForm()) {\n        alert(\"Veuillez remplir tous les champs du formulaire.\");\n        _this2.isSubmitting = false;\n        return;\n      }\n      const birthdate = new Date(_this2.user.dob);\n      const today = new Date();\n      if (birthdate.getFullYear() > today.getFullYear()) {\n        alert(\"Choix incorrect : l'année choisie ne peut pas être supérieure à l'année actuelle.\");\n        _this2.isSubmitting = false;\n        return;\n      }\n      const age = today.getFullYear() - birthdate.getFullYear();\n      const monthDiff = today.getMonth() - birthdate.getMonth();\n      if (age < 18 || age === 18 && monthDiff < 0) {\n        alert(\"Vous devez avoir au moins 18 ans.\");\n        _this2.isSubmitting = false;\n        return;\n      }\n      try {\n        // Appel à la nouvelle route pour récupérer le statut de la comparaison\n        const comparisonResultResponse = yield _this2.http.get('http://localhost:5003/get-comparison-result').toPromise();\n        // Afficher le statut de la comparaison dans la console\n        console.log(\"Statut de la comparaison ######## :\", comparisonResultResponse.statut);\n        // Vérifiez le statut avant d'envoyer les données utilisateur\n        if (comparisonResultResponse.statut === \"ok\") {\n          const userData = {\n            firstName: _this2.user.firstName,\n            lastName: _this2.user.lastName,\n            country: _this2.user.country,\n            city: _this2.user.city,\n            dob: _this2.formatDate(_this2.user.dob),\n            dobArabic: _this2.user.dobArabic,\n            gender: _this2.user.gender,\n            idCardFront: _this2.user.idCardFront,\n            idCardBack: _this2.user.idCardBack,\n            extractedDataFront: _this2.user.extractedDataFront,\n            extractedDataBack: _this2.user.extractedDataBack,\n            selfie: _this2.user.selfie,\n            comparisonStatus: comparisonResultResponse.statut\n          };\n          // Envoi des données à l'API utilisateur\n          _this2.http.post('http://localhost:5000/api/users', userData).subscribe(response => {\n            console.log('Utilisateur ajouté:', response);\n            _this2.resetForm();\n          }, error => {\n            console.error('Erreur lors de l\\'ajout:', error);\n            alert('Erreur lors de l\\'enregistrement: ' + error.error.message);\n          }).add(() => {\n            _this2.isSubmitting = false;\n          });\n        } else {\n          alert(\"La comparaison a échoué : \" + (comparisonResultResponse.message || \"Erreur inconnue\"));\n          _this2.isSubmitting = false;\n          _this2.resetForm();\n        }\n      } catch (error) {\n        console.error(\"Erreur lors de la récupération du statut de la comparaison:\", error);\n        alert(\"Une erreur est survenue lors de la communication avec le serveur.\");\n        _this2.isSubmitting = false;\n      }\n    })();\n  }\n  resetForm() {\n    this.user = {\n      firstName: '',\n      lastName: '',\n      country: '',\n      city: '',\n      dob: '',\n      dobArabic: '',\n      gender: '',\n      genderArabic: '',\n      idCardFront: '',\n      idCardBack: '',\n      extractedDataFront: {},\n      extractedDataBack: {},\n      selfie: null\n    };\n    const fileInputs = document.querySelectorAll('input[type=\"file\"]');\n    fileInputs.forEach(input => input.value = '');\n    const selfiePreview = document.getElementById('selfiePreview');\n    if (selfiePreview) {\n      selfiePreview.src = '';\n    }\n    this.startCamera();\n  }\n  /*\n  checkFocusOut(event: FocusEvent) {\n    const firstname = (event.target as HTMLInputElement).value.trim();\n    if (firstname !== '') {\n      this.http.post('http://localhost:5000/transliterate', { text: firstname })\n        .subscribe({\n          next: (data: any) => console.log('Texte en arabe :', data.arabic),\n          error: err => console.error('Erreur lors de la translittération:', err)\n        });\n    }\n  }*/\n  formatDate(date) {\n    const d = new Date(date);\n    const day = String(d.getDate()).padStart(2, '0');\n    const month = String(d.getMonth() + 1).padStart(2, '0');\n    const year = d.getFullYear();\n    return `${day}/${month}/${year}`;\n  }\n  static {\n    this.ɵfac = function HomeComponent_Factory(t) {\n      return new (t || HomeComponent)(i0.ɵɵdirectiveInject(i1.HttpClient));\n    };\n  }\n  static {\n    this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: HomeComponent,\n      selectors: [[\"app-home\"]],\n      viewQuery: function HomeComponent_Query(rf, ctx) {\n        if (rf & 1) {\n          i0.ɵɵviewQuery(_c0, 5);\n          i0.ɵɵviewQuery(_c1, 5);\n          i0.ɵɵviewQuery(_c2, 5);\n        }\n        if (rf & 2) {\n          let _t;\n          i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.lastNameInput = _t.first);\n          i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.videoElement = _t.first);\n          i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.canvasElement = _t.first);\n        }\n      },\n      decls: 68,\n      vars: 13,\n      consts: [[\"lang\", \"fr\"], [\"charset\", \"UTF-8\"], [\"name\", \"viewport\", \"content\", \"width=device-width, initial-scale=1.0\"], [\"href\", \"https://fonts.googleapis.com/css2?family=Caveat:wght@400;600&display=swap\", \"rel\", \"stylesheet\"], [3, \"ngSubmit\"], [\"form\", \"ngForm\"], [\"for\", \"firstname\"], [\"type\", \"text\", \"id\", \"firstName\", \"name\", \"firstName\", \"required\", \"\", 3, \"ngModel\", \"ngModelChange\", \"blur\"], [\"for\", \"lastname\"], [\"type\", \"text\", \"id\", \"lastName\", \"name\", \"lastName\", \"required\", \"\", 3, \"ngModel\", \"ngModelChange\", \"blur\"], [\"for\", \"country\"], [\"name\", \"country\", \"required\", \"\", 3, \"ngModel\", \"ngModelChange\", \"change\"], [\"country\", \"ngModel\"], [3, \"value\", 4, \"ngFor\", \"ngForOf\"], [\"for\", \"city\"], [\"name\", \"city\", \"required\", \"\", 3, \"ngModel\", \"ngModelChange\"], [\"city\", \"ngModel\"], [\"for\", \"dob\"], [\"type\", \"date\", \"name\", \"dob\", \"required\", \"\", 3, \"ngModel\", \"ngModelChange\", \"change\"], [\"dob\", \"ngModel\"], [\"style\", \"color: red;\", 4, \"ngIf\"], [\"for\", \"selfie\"], [3, \"click\"], [4, \"ngIf\"], [\"type\", \"file\", 3, \"change\"], [\"for\", \"gender\"], [\"name\", \"gender\", \"required\", \"\", 3, \"ngModel\", \"ngModelChange\", \"change\"], [\"gender\", \"ngModel\"], [\"value\", \"\", \"disabled\", \"\", \"selected\", \"\"], [\"value\", \"male\"], [\"value\", \"female\"], [3, \"value\"], [2, \"color\", \"red\"], [2, \"max-width\", \"200px\", 3, \"src\"]],\n      template: function HomeComponent_Template(rf, ctx) {\n        if (rf & 1) {\n          i0.ɵɵelementStart(0, \"html\", 0)(1, \"head\");\n          i0.ɵɵelement(2, \"meta\", 1)(3, \"meta\", 2);\n          i0.ɵɵelementStart(4, \"title\");\n          i0.ɵɵtext(5, \"Formulaire Financier\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelement(6, \"link\", 3);\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(7, \"body\")(8, \"h2\");\n          i0.ɵɵtext(9, \"Ouvrez votre avenir financier avec nous !\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(10, \"form\", 4, 5);\n          i0.ɵɵlistener(\"ngSubmit\", function HomeComponent_Template_form_ngSubmit_10_listener() {\n            return ctx.onSubmit();\n          });\n          i0.ɵɵelementStart(12, \"div\")(13, \"label\", 6);\n          i0.ɵɵtext(14, \"Nom\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(15, \"input\", 7);\n          i0.ɵɵlistener(\"ngModelChange\", function HomeComponent_Template_input_ngModelChange_15_listener($event) {\n            return ctx.user.firstName = $event;\n          })(\"ngModelChange\", function HomeComponent_Template_input_ngModelChange_15_listener() {\n            return ctx.transliterateFirstName();\n          })(\"blur\", function HomeComponent_Template_input_blur_15_listener($event) {\n            return ctx.checkFocusOutFirstName($event);\n          });\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(16, \"div\")(17, \"label\", 8);\n          i0.ɵɵtext(18, \"Pr\\u00E9nom\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(19, \"input\", 9);\n          i0.ɵɵlistener(\"ngModelChange\", function HomeComponent_Template_input_ngModelChange_19_listener($event) {\n            return ctx.user.lastName = $event;\n          })(\"ngModelChange\", function HomeComponent_Template_input_ngModelChange_19_listener() {\n            return ctx.transliterateLastName();\n          })(\"blur\", function HomeComponent_Template_input_blur_19_listener($event) {\n            return ctx.checkFocusOutLastName($event);\n          });\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(20, \"div\")(21, \"label\", 10);\n          i0.ɵɵtext(22, \"Pays\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(23, \"select\", 11, 12);\n          i0.ɵɵlistener(\"ngModelChange\", function HomeComponent_Template_select_ngModelChange_23_listener($event) {\n            return ctx.user.country = $event;\n          })(\"change\", function HomeComponent_Template_select_change_23_listener() {\n            return ctx.onCountryChange();\n          });\n          i0.ɵɵtemplate(25, HomeComponent_option_25_Template, 2, 2, \"option\", 13);\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(26, \"div\")(27, \"label\", 14);\n          i0.ɵɵtext(28, \"Ville\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(29, \"select\", 15, 16);\n          i0.ɵɵlistener(\"ngModelChange\", function HomeComponent_Template_select_ngModelChange_29_listener($event) {\n            return ctx.user.city = $event;\n          });\n          i0.ɵɵtemplate(31, HomeComponent_option_31_Template, 2, 2, \"option\", 13);\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(32, \"div\")(33, \"label\", 17);\n          i0.ɵɵtext(34, \"Date de naissance\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(35, \"input\", 18, 19);\n          i0.ɵɵlistener(\"ngModelChange\", function HomeComponent_Template_input_ngModelChange_35_listener($event) {\n            return ctx.user.dob = $event;\n          })(\"change\", function HomeComponent_Template_input_change_35_listener() {\n            return ctx.onDateChange();\n          });\n          i0.ɵɵelementEnd();\n          i0.ɵɵtemplate(37, HomeComponent_div_37_Template, 2, 1, \"div\", 20);\n          i0.ɵɵtemplate(38, HomeComponent_div_38_Template, 2, 1, \"div\", 20);\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(39, \"div\")(40, \"label\", 21);\n          i0.ɵɵtext(41, \"V\\u00E9rification de vivacit\\u00E9:\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(42, \"button\", 22);\n          i0.ɵɵlistener(\"click\", function HomeComponent_Template_button_click_42_listener() {\n            return ctx.startLivenessDetection();\n          });\n          i0.ɵɵtext(43, \"Commencer la v\\u00E9rification\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵtemplate(44, HomeComponent_div_44_Template, 4, 1, \"div\", 23);\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(45, \"div\")(46, \"label\", 21);\n          i0.ɵɵtext(47, \"Ins\\u00E9rer le recto de votre pi\\u00E8ce d'identit\\u00E9:\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(48, \"input\", 24);\n          i0.ɵɵlistener(\"change\", function HomeComponent_Template_input_change_48_listener($event) {\n            return ctx.onFileChangeRecto($event, ctx.UserFields.IdCardFront);\n          });\n          i0.ɵɵelementEnd();\n          i0.ɵɵtemplate(49, HomeComponent_div_49_Template, 6, 3, \"div\", 23);\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(50, \"div\")(51, \"label\", 21);\n          i0.ɵɵtext(52, \"Ins\\u00E9rer le verso de votre pi\\u00E8ce d'identit\\u00E9:\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(53, \"input\", 24);\n          i0.ɵɵlistener(\"change\", function HomeComponent_Template_input_change_53_listener($event) {\n            return ctx.onFileChangeVerso($event, ctx.UserFields.IdCardBack);\n          });\n          i0.ɵɵelementEnd();\n          i0.ɵɵtemplate(54, HomeComponent_div_54_Template, 6, 3, \"div\", 23);\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(55, \"div\")(56, \"label\", 25);\n          i0.ɵɵtext(57, \"Genre\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(58, \"select\", 26, 27);\n          i0.ɵɵlistener(\"ngModelChange\", function HomeComponent_Template_select_ngModelChange_58_listener($event) {\n            return ctx.user.gender = $event;\n          })(\"change\", function HomeComponent_Template_select_change_58_listener() {\n            return ctx.onGenderChange(ctx.user.gender);\n          });\n          i0.ɵɵelementStart(60, \"option\", 28);\n          i0.ɵɵtext(61, \"Choisissez un genre\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(62, \"option\", 29);\n          i0.ɵɵtext(63, \"Male\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(64, \"option\", 30);\n          i0.ɵɵtext(65, \"Female\");\n          i0.ɵɵelementEnd()()();\n          i0.ɵɵelementStart(66, \"button\", 22);\n          i0.ɵɵlistener(\"click\", function HomeComponent_Template_button_click_66_listener() {\n            return ctx.onSubmit();\n          });\n          i0.ɵɵtext(67, \"Submit\");\n          i0.ɵɵelementEnd()()()();\n        }\n        if (rf & 2) {\n          i0.ɵɵadvance(15);\n          i0.ɵɵproperty(\"ngModel\", ctx.user.firstName);\n          i0.ɵɵadvance(4);\n          i0.ɵɵproperty(\"ngModel\", ctx.user.lastName);\n          i0.ɵɵadvance(4);\n          i0.ɵɵproperty(\"ngModel\", ctx.user.country);\n          i0.ɵɵadvance(2);\n          i0.ɵɵproperty(\"ngForOf\", ctx.countries);\n          i0.ɵɵadvance(4);\n          i0.ɵɵproperty(\"ngModel\", ctx.user.city);\n          i0.ɵɵadvance(2);\n          i0.ɵɵproperty(\"ngForOf\", ctx.cities);\n          i0.ɵɵadvance(4);\n          i0.ɵɵproperty(\"ngModel\", ctx.user.dob);\n          i0.ɵɵadvance(2);\n          i0.ɵɵproperty(\"ngIf\", ctx.ageError);\n          i0.ɵɵadvance(1);\n          i0.ɵɵproperty(\"ngIf\", ctx.dateError);\n          i0.ɵɵadvance(6);\n          i0.ɵɵproperty(\"ngIf\", ctx.user.selfie);\n          i0.ɵɵadvance(5);\n          i0.ɵɵproperty(\"ngIf\", ctx.user.extractedDataFront);\n          i0.ɵɵadvance(5);\n          i0.ɵɵproperty(\"ngIf\", ctx.user.extractedDataBack);\n          i0.ɵɵadvance(4);\n          i0.ɵɵproperty(\"ngModel\", ctx.user.gender);\n        }\n      },\n      dependencies: [i2.NgForOf, i2.NgIf, i3.ɵNgNoValidate, i3.NgSelectOption, i3.ɵNgSelectMultipleOption, i3.DefaultValueAccessor, i3.SelectControlValueAccessor, i3.NgControlStatus, i3.NgControlStatusGroup, i3.RequiredValidator, i3.NgModel, i3.NgForm, i2.JsonPipe],\n      styles: [\"@charset \\\"UTF-8\\\";\\n\\n\\n\\n\\nform[_ngcontent-%COMP%] {\\n  max-width: 600px;\\n  margin: 2rem auto;\\n  padding: 2rem;\\n  background: linear-gradient(145deg, #ffffff, #f0f0f0);\\n  border-radius: 15px;\\n  box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);\\n  transition: transform 0.3s ease, box-shadow 0.3s ease;\\n}\\nform[_ngcontent-%COMP%]:hover {\\n  transform: translateY(-5px);\\n  box-shadow: 0 15px 40px rgba(0, 0, 0, 0.2);\\n}\\n\\n\\n\\nlabel[_ngcontent-%COMP%] {\\n  display: block;\\n  margin-bottom: 0.5rem;\\n  font-weight: 600;\\n  color: #333;\\n}\\n\\n\\n\\ninput[_ngcontent-%COMP%], select[_ngcontent-%COMP%] {\\n  width: 100%;\\n  padding: 0.75rem;\\n  margin-bottom: 1rem;\\n  border: 1px solid #ddd;\\n  border-radius: 8px;\\n  font-size: 1rem;\\n  color: #555;\\n  background-color: #f9f9f9;\\n  transition: border-color 0.3s ease, box-shadow 0.3s ease;\\n}\\ninput[_ngcontent-%COMP%]:focus, select[_ngcontent-%COMP%]:focus {\\n  border-color: #007bff;\\n  box-shadow: 0 0 8px rgba(0, 123, 255, 0.3);\\n  outline: none;\\n}\\n\\n\\n\\nbutton[_ngcontent-%COMP%] {\\n  display: block;\\n  width: 100%;\\n  padding: 1rem;\\n  background: linear-gradient(145deg, #007bff, #0056b3);\\n  color: white;\\n  border: none;\\n  border-radius: 8px;\\n  font-size: 1rem;\\n  font-weight: 600;\\n  cursor: pointer;\\n  transition: background 0.3s ease, transform 0.3s ease;\\n}\\nbutton[_ngcontent-%COMP%]:hover {\\n  background: linear-gradient(145deg, #0056b3, #007bff);\\n  transform: translateY(-2px);\\n}\\nbutton[_ngcontent-%COMP%]:disabled {\\n  background: #ccc;\\n  cursor: not-allowed;\\n  transform: none;\\n}\\n\\n\\n\\n.error-message[_ngcontent-%COMP%] {\\n  color: #dc3545;\\n  font-size: 0.875rem;\\n  margin-top: -0.5rem;\\n  margin-bottom: 1rem;\\n  animation: _ngcontent-%COMP%_fadeIn 0.5s ease;\\n}\\n\\n@keyframes _ngcontent-%COMP%_fadeIn {\\n  from {\\n    opacity: 0;\\n    transform: translateY(-10px);\\n  }\\n  to {\\n    opacity: 1;\\n    transform: translateY(0);\\n  }\\n}\\n\\n\\nselect[_ngcontent-%COMP%] {\\n  appearance: none;\\n  background-image: url(\\\"data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22292.4%22%20height%3D%22292.4%22%3E%3Cpath%20fill%3D%22%23007bff%22%20d%3D%22M287%2069.4a17.6%2017.6%200%200%200-13-5.4H18.4c-5%200-9.3%201.8-12.9%205.4A17.6%2017.6%200%200%200%200%2082.2c0%205%201.8%209.3%205.4%2012.9l128%20127.9c3.6%203.6%207.8%205.4%2012.8%205.4s9.2-1.8%2012.8-5.4L287%2095c3.5-3.5%205.4-7.8%205.4-12.8%200-5-1.9-9.2-5.5-12.8z%22%2F%3E%3C%2Fsvg%3E\\\");\\n  background-repeat: no-repeat;\\n  background-position: right 0.75rem center;\\n  background-size: 12px;\\n}\\n\\n\\n\\ndiv[_ngcontent-%COMP%] {\\n  margin-bottom: 1.5rem;\\n}\\n\\n\\n\\nh2[_ngcontent-%COMP%] {\\n  text-align: center;\\n  margin-bottom: 2rem;\\n  font-size: 4rem; \\n\\n  color: #007bff;\\n  text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);\\n  font-family: \\\"Caveat\\\", cursive; \\n\\n}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9hcHAvaG9tZS9ob21lLmNvbXBvbmVudC5zY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLGdCQUFnQjtBQUFoQix3QkFBQTtBQUVBLGdDQUFBO0FBQ0E7RUFDRSxnQkFBQTtFQUNBLGlCQUFBO0VBQ0EsYUFBQTtFQUNBLHFEQUFBO0VBQ0EsbUJBQUE7RUFDQSwwQ0FBQTtFQUNBLHFEQUFBO0FBQ0Y7QUFDRTtFQUNFLDJCQUFBO0VBQ0EsMENBQUE7QUFDSjs7QUFHQSxxQkFBQTtBQUNBO0VBQ0UsY0FBQTtFQUNBLHFCQUFBO0VBQ0EsZ0JBQUE7RUFDQSxXQUFBO0FBQUY7O0FBR0EsZ0NBQUE7QUFDQTtFQUNFLFdBQUE7RUFDQSxnQkFBQTtFQUNBLG1CQUFBO0VBQ0Esc0JBQUE7RUFDQSxrQkFBQTtFQUNBLGVBQUE7RUFDQSxXQUFBO0VBQ0EseUJBQUE7RUFDQSx3REFBQTtBQUFGO0FBRUU7RUFDRSxxQkFBQTtFQUNBLDBDQUFBO0VBQ0EsYUFBQTtBQUFKOztBQUlBLGtDQUFBO0FBQ0E7RUFDRSxjQUFBO0VBQ0EsV0FBQTtFQUNBLGFBQUE7RUFDQSxxREFBQTtFQUNBLFlBQUE7RUFDQSxZQUFBO0VBQ0Esa0JBQUE7RUFDQSxlQUFBO0VBQ0EsZ0JBQUE7RUFDQSxlQUFBO0VBQ0EscURBQUE7QUFERjtBQUdFO0VBQ0UscURBQUE7RUFDQSwyQkFBQTtBQURKO0FBSUU7RUFDRSxnQkFBQTtFQUNBLG1CQUFBO0VBQ0EsZUFBQTtBQUZKOztBQU1BLHlDQUFBO0FBQ0E7RUFDRSxjQUFBO0VBQ0EsbUJBQUE7RUFDQSxtQkFBQTtFQUNBLG1CQUFBO0VBQ0EsMkJBQUE7QUFIRjs7QUFNQTtFQUNFO0lBQ0UsVUFBQTtJQUNBLDRCQUFBO0VBSEY7RUFLQTtJQUNFLFVBQUE7SUFDQSx3QkFBQTtFQUhGO0FBQ0Y7QUFNQSxrREFBQTtBQUNBO0VBQ0UsZ0JBQUE7RUFDQSxvZkFBQTtFQUNBLDRCQUFBO0VBQ0EseUNBQUE7RUFDQSxxQkFBQTtBQUpGOztBQU9BLHVDQUFBO0FBQ0E7RUFDRSxxQkFBQTtBQUpGOztBQU9BLHNDQUFBO0FBQ0E7RUFDRSxrQkFBQTtFQUNBLG1CQUFBO0VBQ0EsZUFBQSxFQUFBLG9DQUFBO0VBQ0EsY0FBQTtFQUNBLDJDQUFBO0VBQ0EsOEJBQUEsRUFBQSwrQkFBQTtBQUpGIiwic291cmNlc0NvbnRlbnQiOlsiLyogaG9tZS5jb21wb25lbnQuc2NzcyAqL1xuXG4vKiBTdHlsZSBnw4PCqW7Dg8KpcmFsIGR1IGZvcm11bGFpcmUgKi9cbmZvcm0ge1xuICBtYXgtd2lkdGg6IDYwMHB4O1xuICBtYXJnaW46IDJyZW0gYXV0bztcbiAgcGFkZGluZzogMnJlbTtcbiAgYmFja2dyb3VuZDogbGluZWFyLWdyYWRpZW50KDE0NWRlZywgI2ZmZmZmZiwgI2YwZjBmMCk7XG4gIGJvcmRlci1yYWRpdXM6IDE1cHg7XG4gIGJveC1zaGFkb3c6IDAgMTBweCAzMHB4IHJnYmEoMCwgMCwgMCwgMC4xKTtcbiAgdHJhbnNpdGlvbjogdHJhbnNmb3JtIDAuM3MgZWFzZSwgYm94LXNoYWRvdyAwLjNzIGVhc2U7XG5cbiAgJjpob3ZlciB7XG4gICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVZKC01cHgpO1xuICAgIGJveC1zaGFkb3c6IDAgMTVweCA0MHB4IHJnYmEoMCwgMCwgMCwgMC4yKTtcbiAgfVxufVxuXG4vKiBTdHlsZSBkZXMgbGFiZWxzICovXG5sYWJlbCB7XG4gIGRpc3BsYXk6IGJsb2NrO1xuICBtYXJnaW4tYm90dG9tOiAwLjVyZW07XG4gIGZvbnQtd2VpZ2h0OiA2MDA7XG4gIGNvbG9yOiAjMzMzO1xufVxuXG4vKiBTdHlsZSBkZXMgaW5wdXRzIGV0IHNlbGVjdHMgKi9cbmlucHV0LCBzZWxlY3Qge1xuICB3aWR0aDogMTAwJTtcbiAgcGFkZGluZzogMC43NXJlbTtcbiAgbWFyZ2luLWJvdHRvbTogMXJlbTtcbiAgYm9yZGVyOiAxcHggc29saWQgI2RkZDtcbiAgYm9yZGVyLXJhZGl1czogOHB4O1xuICBmb250LXNpemU6IDFyZW07XG4gIGNvbG9yOiAjNTU1O1xuICBiYWNrZ3JvdW5kLWNvbG9yOiAjZjlmOWY5O1xuICB0cmFuc2l0aW9uOiBib3JkZXItY29sb3IgMC4zcyBlYXNlLCBib3gtc2hhZG93IDAuM3MgZWFzZTtcblxuICAmOmZvY3VzIHtcbiAgICBib3JkZXItY29sb3I6ICMwMDdiZmY7XG4gICAgYm94LXNoYWRvdzogMCAwIDhweCByZ2JhKDAsIDEyMywgMjU1LCAwLjMpO1xuICAgIG91dGxpbmU6IG5vbmU7XG4gIH1cbn1cblxuLyogU3R5bGUgZHUgYm91dG9uIGRlIHNvdW1pc3Npb24gKi9cbmJ1dHRvbiB7XG4gIGRpc3BsYXk6IGJsb2NrO1xuICB3aWR0aDogMTAwJTtcbiAgcGFkZGluZzogMXJlbTtcbiAgYmFja2dyb3VuZDogbGluZWFyLWdyYWRpZW50KDE0NWRlZywgIzAwN2JmZiwgIzAwNTZiMyk7XG4gIGNvbG9yOiB3aGl0ZTtcbiAgYm9yZGVyOiBub25lO1xuICBib3JkZXItcmFkaXVzOiA4cHg7XG4gIGZvbnQtc2l6ZTogMXJlbTtcbiAgZm9udC13ZWlnaHQ6IDYwMDtcbiAgY3Vyc29yOiBwb2ludGVyO1xuICB0cmFuc2l0aW9uOiBiYWNrZ3JvdW5kIDAuM3MgZWFzZSwgdHJhbnNmb3JtIDAuM3MgZWFzZTtcblxuICAmOmhvdmVyIHtcbiAgICBiYWNrZ3JvdW5kOiBsaW5lYXItZ3JhZGllbnQoMTQ1ZGVnLCAjMDA1NmIzLCAjMDA3YmZmKTtcbiAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVkoLTJweCk7XG4gIH1cblxuICAmOmRpc2FibGVkIHtcbiAgICBiYWNrZ3JvdW5kOiAjY2NjO1xuICAgIGN1cnNvcjogbm90LWFsbG93ZWQ7XG4gICAgdHJhbnNmb3JtOiBub25lO1xuICB9XG59XG5cbi8qIEFuaW1hdGlvbiBwb3VyIGxlcyBtZXNzYWdlcyBkJ2VycmV1ciAqL1xuLmVycm9yLW1lc3NhZ2Uge1xuICBjb2xvcjogI2RjMzU0NTtcbiAgZm9udC1zaXplOiAwLjg3NXJlbTtcbiAgbWFyZ2luLXRvcDogLTAuNXJlbTtcbiAgbWFyZ2luLWJvdHRvbTogMXJlbTtcbiAgYW5pbWF0aW9uOiBmYWRlSW4gMC41cyBlYXNlO1xufVxuXG5Aa2V5ZnJhbWVzIGZhZGVJbiB7XG4gIGZyb20ge1xuICAgIG9wYWNpdHk6IDA7XG4gICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVZKC0xMHB4KTtcbiAgfVxuICB0byB7XG4gICAgb3BhY2l0eTogMTtcbiAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVkoMCk7XG4gIH1cbn1cblxuLyogU3R5bGUgcG91ciBsZXMgc8ODwqlsZWN0ZXVycyBkZSBwYXlzIGV0IGRlIHZpbGxlICovXG5zZWxlY3Qge1xuICBhcHBlYXJhbmNlOiBub25lO1xuICBiYWNrZ3JvdW5kLWltYWdlOiB1cmwoXCJkYXRhOmltYWdlL3N2Zyt4bWw7Y2hhcnNldD1VUy1BU0NJSSwlM0NzdmclMjB4bWxucyUzRCUyMmh0dHAlM0ElMkYlMkZ3d3cudzMub3JnJTJGMjAwMCUyRnN2ZyUyMiUyMHdpZHRoJTNEJTIyMjkyLjQlMjIlMjBoZWlnaHQlM0QlMjIyOTIuNCUyMiUzRSUzQ3BhdGglMjBmaWxsJTNEJTIyJTIzMDA3YmZmJTIyJTIwZCUzRCUyMk0yODclMjA2OS40YTE3LjYlMjAxNy42JTIwMCUyMDAlMjAwLTEzLTUuNEgxOC40Yy01JTIwMC05LjMlMjAxLjgtMTIuOSUyMDUuNEExNy42JTIwMTcuNiUyMDAlMjAwJTIwMCUyMDAlMjA4Mi4yYzAlMjA1JTIwMS44JTIwOS4zJTIwNS40JTIwMTIuOWwxMjglMjAxMjcuOWMzLjYlMjAzLjYlMjA3LjglMjA1LjQlMjAxMi44JTIwNS40czkuMi0xLjglMjAxMi44LTUuNEwyODclMjA5NWMzLjUtMy41JTIwNS40LTcuOCUyMDUuNC0xMi44JTIwMC01LTEuOS05LjItNS41LTEyLjh6JTIyJTJGJTNFJTNDJTJGc3ZnJTNFXCIpO1xuICBiYWNrZ3JvdW5kLXJlcGVhdDogbm8tcmVwZWF0O1xuICBiYWNrZ3JvdW5kLXBvc2l0aW9uOiByaWdodCAwLjc1cmVtIGNlbnRlcjtcbiAgYmFja2dyb3VuZC1zaXplOiAxMnB4O1xufVxuXG4vKiBTdHlsZSBwb3VyIGxlIGNvbnRlbmV1ciBkZXMgY2hhbXBzICovXG5kaXYge1xuICBtYXJnaW4tYm90dG9tOiAxLjVyZW07XG59XG5cbi8qIFN0eWxlIHBvdXIgbGUgdGl0cmUgZHUgZm9ybXVsYWlyZSAqL1xuaDIge1xuICB0ZXh0LWFsaWduOiBjZW50ZXI7XG4gIG1hcmdpbi1ib3R0b206IDJyZW07XG4gIGZvbnQtc2l6ZTogNHJlbTsgLyogQWp1c3RleiBsYSB0YWlsbGUgc2kgbsODwqljZXNzYWlyZSAqL1xuICBjb2xvcjogIzAwN2JmZjtcbiAgdGV4dC1zaGFkb3c6IDJweCAycHggNHB4IHJnYmEoMCwgMCwgMCwgMC4xKTtcbiAgZm9udC1mYW1pbHk6ICdDYXZlYXQnLCBjdXJzaXZlOyAvKiBBcHBsaXF1ZSBsYSBwb2xpY2UgUG9wcGlucyAqL1xufSJdLCJzb3VyY2VSb290IjoiIn0= */\"]\n    });\n  }\n}","map":{"version":3,"names":["i0","ɵɵelementStart","ɵɵtext","ɵɵelementEnd","ɵɵproperty","country_r12","ɵɵadvance","ɵɵtextInterpolate","city_r13","ctx_r6","ageError","ctx_r7","dateError","ɵɵelement","ctx_r8","user","selfie","ɵɵsanitizeUrl","ɵɵpipeBind1","ctx_r9","extractedDataFront","ctx_r10","extractedDataBack","UserFields","HomeComponent","constructor","http","lastNameInput","videoElement","canvasElement","firstName","lastName","country","city","dob","dobArabic","gender","genderArabic","idCardFront","idCardBack","countries","citiesByCountry","cities","selectedVersoImage","selectedVersoImageHash","isSubmitting","previousFirstname","previousLastname","ngOnInit","video","document","getElementById","navigator","mediaDevices","getUserMedia","then","stream","srcObject","catch","error","console","onFileChangeRecto","event","field","input","target","files","length","file","formData","FormData","append","post","subscribe","response","log","genre","alert","message","getBase64Image","base64","donnees","ocrData","processVersoImage","image","onFileChangeVerso","name","lastModified","reader","FileReader","readAsDataURL","Promise","resolve","onload","result","validateForm","startLivenessDetection","_this","_asyncToGenerator","stopCamera","toPromise","Error","success","get","responseType","blob","restartCamera","nativeElement","getTracks","forEach","track","stop","setTimeout","startCamera","onCountryChange","selectedCountry","convertDateToArabic","dateStr","reject","parts","split","day","month","year","monthNames","monthIndex","parseInt","arabicDate","onDateChange","birthdate","Date","today","getFullYear","age","monthDiff","getMonth","formattedDate","formatDate","sendTransliteratedDate","apiUrl","data","headers","onGenderChange","sendTransliteratedGender","style","display","tracks","checkFocusOutFirstName","firstname","value","trim","sendTransliteratedName","checkFocusOutLastName","lastname","transliteratedName","sendData","sendResponse","sendError","transliterateFirstName","transliterateLastName","onSubmit","_this2","comparisonResultResponse","statut","userData","comparisonStatus","resetForm","add","fileInputs","querySelectorAll","selfiePreview","src","date","d","String","getDate","padStart","ɵɵdirectiveInject","i1","HttpClient","selectors","viewQuery","HomeComponent_Query","rf","ctx","ɵɵlistener","HomeComponent_Template_form_ngSubmit_10_listener","HomeComponent_Template_input_ngModelChange_15_listener","$event","HomeComponent_Template_input_blur_15_listener","HomeComponent_Template_input_ngModelChange_19_listener","HomeComponent_Template_input_blur_19_listener","HomeComponent_Template_select_ngModelChange_23_listener","HomeComponent_Template_select_change_23_listener","ɵɵtemplate","HomeComponent_option_25_Template","HomeComponent_Template_select_ngModelChange_29_listener","HomeComponent_option_31_Template","HomeComponent_Template_input_ngModelChange_35_listener","HomeComponent_Template_input_change_35_listener","HomeComponent_div_37_Template","HomeComponent_div_38_Template","HomeComponent_Template_button_click_42_listener","HomeComponent_div_44_Template","HomeComponent_Template_input_change_48_listener","IdCardFront","HomeComponent_div_49_Template","HomeComponent_Template_input_change_53_listener","IdCardBack","HomeComponent_div_54_Template","HomeComponent_Template_select_ngModelChange_58_listener","HomeComponent_Template_select_change_58_listener","HomeComponent_Template_button_click_66_listener"],"sources":["D:\\3emeISAMM\\PFE\\Code\\user-form\\src\\app\\home\\home.component.ts","D:\\3emeISAMM\\PFE\\Code\\user-form\\src\\app\\home\\home.component.html"],"sourcesContent":["import { HttpClient } from '@angular/common/http';\nimport { Component, ElementRef, ViewChild } from '@angular/core';\n\nenum UserFields {\n  FirstName = 'firstName',\n  LastName = 'lastName',\n  Country = 'country',\n  City = 'city',\n  Dob = 'dob',\n  Gender = 'gender',\n  IdCardFront = 'idCardFront',\n  IdCardBack = 'idCardBack',\n  Selfie = 'selfie'\n}\n\n@Component({\n  selector: 'app-home',\n  templateUrl: './home.component.html',\n  styleUrls: ['./home.component.scss']\n})\nexport class HomeComponent {\n  UserFields = UserFields; // Exposer l'énumération\n  @ViewChild('lastNameInput') lastNameInput: ElementRef | null = null; // Référence pour le champ lastName\n  @ViewChild('videoElement') videoElement: ElementRef | null = null;\n  @ViewChild('canvasElement') canvasElement: ElementRef | null = null;\n\n  user = {\n    firstName: '',\n    lastName: '',\n    country: '',\n    city: '',\n    dob: '',\n    dobArabic:'',\n    gender: '',\n    genderArabic:'',\n    idCardFront: '' as string | null, // Image en base64\n    idCardBack: '' as string | null, // Image en base64\n    extractedDataFront: {}, // Résultats extractés (Recto)\n    extractedDataBack: {}, // Résultats extractés (Verso)\n    selfie: '' as string | null\n};\n\n  ageError: string = '';\n  dateError: string = '';\n\n  countries: string[] = [\"Tunisie\"];\n\n  citiesByCountry: { [key: string]: string[] } = {\n      \"Tunisie\": [\"Nabeul\", \"Qurbus\", \"Kélibia\", \"Yasmine Hammamet\", \"Kerkouane\", \"Al Huwariyah\", \n        \"Kairouan\", \"Douz\", \"Nefta\", \"Ksar Ghilane\", \"Gafsa\", \"Degueche\", \"Shabikah\", \"Tozeur\", \n        \"Bizerte\", \"Takrouna\", \"Djebba\", \"Midoun\", \"Djerba Ajim\", \"Ghizen\", \"Arkou\", \"Houmt Souk\", \n        \"Aghir\", \"Hara Sghira Er Riadh\", \"Mellita\", \"Souk Houmet\", \"Mezraia\", \"Djerba Midun\", \n        \"Ksar Hadada\", \"Tataouine Nord\", \"Tataouine Ville\", \"Ghomrassen\", \"Testour\", \"Kesra\", \n        \"Beja, Tunisie\", \"Le Kef\", \"Makthar\", \"Sabria\", \"Toujane\", \"Zaghouan\", \"Zriba\", \"Matmata\", \n        \"Gabès Médina\", \"Tamezret\", \"La Marsa\", \"La Goulette\", \"Tunis\", \"Carthage\", \"Sidi Bou Saïd\", \n        \"Sbeïtla\", \"Monastir\", \"Sahline\", \"Ariana, Tunisie\", \"CHENINI\", \"Douiret\", \"Bani Khedeche\", \n        \"Ksar Ouled Brahim\", \"Sangho\", \"Médine\", \"Mahboubine\", \"Khalfallah\", \"Ksar Hallouf\", \"Zarzis\", \n        \"Guellala\", \"Hammam Sousse\", \"Hammamet\", \"Sousse\", \"M'saken\", \"El Jem\", \"Hiboun\", \"Mahdia\"],\n};\n\n  cities: string[] = [];\n\n  constructor(private http: HttpClient) {}\n\n  ngOnInit() {\n    const video = document.getElementById('videoElement') as HTMLVideoElement;\n    navigator.mediaDevices.getUserMedia({ video: true })\n      .then(stream => {\n        video.srcObject = stream;\n      })\n      .catch(error => {\n        console.error(\"Erreur lors de l'accès à la caméra : \", error);\n      });\n  }\n\n\n  onFileChangeRecto(event: Event, field: UserFields) {\n    const input = event.target as HTMLInputElement;\n    if (input.files && input.files.length > 0) {\n      const file = input.files[0];\n  \n      // Appeler le serveur pour traiter l'image\n      const formData = new FormData();\n      formData.append('image', file);\n  \n      this.http.post('http://localhost:5001/ocr/recto', formData)\n        .subscribe((response: any) => {\n          console.log('Résultat OCR Recto:', response);\n          \n          // Stocker le genre en arabe\n          this.user.gender = response.genre === 'male' ? 'ذكر' : 'أنثى'; \n  \n          if (response.error) {\n            alert('Erreur : ' + response.message);\n            return;\n          }\n  \n          this.getBase64Image(file).then(base64 => {\n            this.user.idCardFront = base64;\n          });\n          this.user.extractedDataFront = response.donnees;\n  \n          // Envoyer les données à comparaison_N_P.py\n          const ocrData = {\n            'ocr_result': this.user.extractedDataFront,\n            'genre': this.user.gender // Envoyer le genre au serveur\n          };\n  \n          this.http.post('http://localhost:5003/ocr-extraction', ocrData)\n            .subscribe((response: any) => {\n              console.log(`Résultats d'extraction OCR envoyés au serveur Python :`, response);\n            }, error => {\n              console.error('Erreur lors de l\\'envoi des données à comparaison_N_P.py (OCR Recto):', error);\n            });\n  \n          if (this.selectedVersoImage) {\n            this.processVersoImage(this.selectedVersoImage);\n          }\n        }, error => {\n          console.error('Erreur lors du traitement OCR Recto :', error);\n        });\n    }\n  }\n  \n\n  \nprocessVersoImage(image: File) {\n  // Nettoyer les données précédentes du Verso\n  this.user.idCardBack = null;\n  this.user.extractedDataBack = {};\n\n  const formData = new FormData();\n  formData.append('image', image);\n\n  this.http.post('http://localhost:5002/ocr/verso', formData)\n      .subscribe((response: any) => {\n          console.log('Résultat OCR Verso:', response);\n          if (response.message === \"Conditions non remplies\") {\n            alert(\"Erreur : L'image Verso sélectionnée ne correspond pas aux critères attendus.\");\n            return;\n          }\n          this.getBase64Image(image).then(base64 => {\n              this.user.idCardBack = base64;\n          });\n          this.user.extractedDataBack = response.donnees; // Stocker les résultats extractés\n      }, error => {\n          console.error('Erreur lors du traitement OCR Verso:', error);\n      });\n}\n\nselectedVersoImage: File | null = null;\nselectedVersoImageHash: string | null = null;\n\nonFileChangeVerso(event: Event, field: UserFields) {\n    const input = event.target as HTMLInputElement;\n    if (input.files && input.files.length > 0) {\n        this.selectedVersoImage = input.files[0]; // Stocker l'image Verso\n        this.selectedVersoImageHash = this.selectedVersoImage.name + this.selectedVersoImage.lastModified;\n        const file = input.files[0];\n\n        // Appeler le serveur pour traiter l'image\n        const formData = new FormData();\n        formData.append('image', file);\n\n        this.http.post('http://localhost:5002/ocr/verso', formData)\n            .subscribe((response: any) => {\n                console.log('Résultat OCR Verso:', response);\n                if (response.message === \"Conditions non remplies\") {\n                  alert(\"Erreur : L'image Verso sélectionnée ne correspond pas aux critères attendus.\");\n                  return;\n                }\n                this.getBase64Image(file).then(base64 => {\n                  this.user.idCardBack = base64;\n                });\n                this.user.extractedDataBack = response.donnees; // Stocker les résultats extractés\n            }, error => {\n                console.error('Erreur lors du traitement OCR Verso:', error);\n            });\n    }\n}\n\n// Nouvelle méthode pour convertir l'image en base64\ngetBase64Image(file: File): Promise<string | null> {\n  const reader = new FileReader();\n  reader.readAsDataURL(file);\n  return new Promise(resolve => {\n    reader.onload = () => resolve(reader.result as string);\n  });\n}\n\n\n  validateForm(): boolean {\n    return (\n      this.user.firstName !== '' &&\n      this.user.lastName !== '' &&\n      this.user.country !== '' &&\n      this.user.city !== '' &&\n      this.user.dob !== '' &&\n      this.user.gender !== '' &&\n      this.user.idCardFront !== null &&\n      this.user.idCardBack !== null &&\n      this.user.selfie !== null\n    );\n  }\n  \n\n\n  async startLivenessDetection() {\n    interface LivenessResponse {\n      success: boolean;\n      message?: string;\n    }\n    // Arrêter la caméra simple si elle est en cours\n    this.stopCamera();\n  \n    try {\n      // Spécifiez le type de réponse attendu\n      const response = await this.http.post<LivenessResponse>(\n        'http://localhost:5004/start-liveness-detection', \n        {}\n      ).toPromise();\n  \n      // Vérifiez que la réponse existe\n      if (!response) {\n        throw new Error('Aucune réponse du serveur de détection de vivacité');\n      }\n  \n      if (response.success) {\n        // Si la détection réussit, récupérer l'image finale\n        this.http.get('http://localhost:5004/get-liveness-result', { responseType: 'blob' })\n          .subscribe(blob => {\n            const reader = new FileReader();\n            reader.onload = () => {\n              this.user.selfie = reader.result as string;\n            };\n            reader.readAsDataURL(blob);\n          }, error => {\n            console.error(\"Erreur lors de la récupération de l'image:\", error);\n            alert(\"Erreur lors de la récupération de l'image de vérification\");\n          });\n      } else {\n        alert(\"Échec de la vérification de vivacité: \" + (response.message || 'Raison inconnue'));\n      }\n    } catch (error) {\n      console.error(\"Erreur lors de la détection de vivacité:\", error);\n      alert(\"Erreur lors de la vérification de vivacité\");\n    }\n  }\n\n  \n\nrestartCamera() {\n  if (this.videoElement?.nativeElement) {\n    const stream = this.videoElement.nativeElement.srcObject as MediaStream;\n    if (stream) {\n      stream.getTracks().forEach(track => track.stop());\n    }\n  }\n\n  setTimeout(() => {\n    this.startCamera();\n  }, 500);\n}\n\n\n  \n\n  onCountryChange() {\n    const selectedCountry = this.user.country;\n    this.cities = this.citiesByCountry[selectedCountry] || [];\n    this.user.city = '';\n  }\n  \n\n\n\n  convertDateToArabic(dateStr: string): Promise<string> {\n    return new Promise((resolve, reject) => {\n      if (!dateStr) {\n        resolve('');\n        return;\n      }\n  \n      const parts = dateStr.split('/');\n      if (parts.length !== 3) {\n        resolve(dateStr); // Retourne la date originale si le format est incorrect\n        return;\n      }\n  \n      const day = parts[0];\n      const month = parts[1];\n      const year = parts[2];\n  \n      const monthNames = ['جانفي', 'فيفري','مارس','أفريل','ماي','جوان','جويلية','أوت','سبتمبر','أكتوبر','نوفمبر','ديسمبر'];\n      \n  \n      const monthIndex = parseInt(month, 10) - 1;\n      if (monthIndex < 0 || monthIndex >= 12) {\n        resolve(dateStr); // Retourne la date originale si le mois est invalide\n        return;\n      }\n  \n      const arabicDate = `${day} ${monthNames[monthIndex]} ${year}`;\n      resolve(arabicDate);\n    });\n  }\n  \n\n\n  onDateChange() {\n    const birthdate = new Date(this.user.dob);\n    const today = new Date();\n    \n    if (birthdate.getFullYear() > today.getFullYear()) {\n      this.dateError = \"Choix incorrect : l'année choisie ne peut pas être supérieure à l'année actuelle.\";\n      this.ageError = \"\";\n      return;\n    } else {\n      this.dateError = \"\";\n    }\n  \n    const age = today.getFullYear() - birthdate.getFullYear();\n    const monthDiff = today.getMonth() - birthdate.getMonth();\n  \n    if (age < 18 || (age === 18 && monthDiff < 0)) {\n      this.ageError = \"Vous devez avoir au moins 18 ans.\";\n    } else {\n      this.ageError = \"\";\n    }\n  \n    // Convertir la date en format arabe et l'envoyer au serveur\n    const formattedDate = this.formatDate(this.user.dob);\n    this.convertDateToArabic(formattedDate).then(arabicDate => {\n      this.user.dobArabic = arabicDate;\n      console.log('Date transformée en arabe:', this.user.dobArabic);\n      \n      // Envoyer la date au serveur\n      this.sendTransliteratedDate(arabicDate);\n    }).catch(error => {\n      console.error('Erreur lors de la conversion de la date:', error);\n    });\n  }\n\n  sendTransliteratedDate(arabicDate: string) {\n    const apiUrl = 'http://localhost:5003/transliterate-names';\n    const data = {\n      'تاريخ الولادة': arabicDate,\n    };\n  \n    this.http.post(apiUrl, data, { headers: { 'Content-Type': 'application/json' } })\n      .subscribe(response => {\n        console.log('Date en arabe envoyée avec succès:', response);\n      }, error => {\n        console.error('Erreur lors de l\\'envoi de la date:', error);\n      });\n  }\n  \n\n\n\n\n\n\n  onGenderChange(genre: string) {\n    this.user.genderArabic = genre; // Mettre à jour le genre dans l'objet user\n    console.log('Genre sélectionné:', this.user.genderArabic);\n    \n    // Envoyer le genre au serveur\n    this.sendTransliteratedGender(genre);\n}\n\nsendTransliteratedGender(genre: string) {\n    const apiUrl = 'http://localhost:5003/transliterate-names';\n\n    // Convertir le genre en arabe\n    const genderArabic = (genre === 'male') ? 'ذكر' : 'أنثى';\n\n    const data = {\n        'الجنس': genderArabic // Utiliser le genre en arabe\n    };\n\n    this.http.post(apiUrl, data, { headers: { 'Content-Type': 'application/json' } })\n        .subscribe(response => {\n            console.log('Genre en arabe envoyé avec succès:', response);\n        }, error => {\n            console.error('Erreur lors de l\\'envoi du genre:', error);\n        });\n}\n\n  \n\n  \n\n  \n\n  isSubmitting = false;\n\n  startCamera() {\n    const video = document.getElementById('videoElement') as HTMLVideoElement;\n  \n    if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {\n      navigator.mediaDevices.getUserMedia({ video: true })\n        .then(stream => {\n          video.srcObject = stream;\n          video.style.display = \"block\"; // Rendre la vidéo visible\n        })\n        .catch(error => {\n          console.error(\"Erreur d'accès à la caméra :\", error);\n        });\n    }\n  }\n  \n  stopCamera() {\n    const video = document.getElementById('videoElement') as HTMLVideoElement;\n    const stream = video.srcObject as MediaStream;\n  \n    if (stream) {\n      const tracks = stream.getTracks();\n      tracks.forEach(track => track.stop()); // Arrêter la caméra\n      video.srcObject = null;\n      video.style.display = \"none\"; // Cacher la vidéo\n    }\n  }\n\n  checkFocusOutFirstName(event: FocusEvent) {\n    const firstname = (event.target as HTMLInputElement).value.trim();\n    if (firstname!== '' && firstname!== this.previousFirstname) {\n      this.sendTransliteratedName('firstName', firstname);\n      this.previousFirstname = firstname;\n    }\n  }\n  \n  checkFocusOutLastName(event: FocusEvent) {\n    const lastname = (event.target as HTMLInputElement).value.trim();\n    if (lastname!== '' && lastname!== this.previousLastname) {\n      this.sendTransliteratedName('lastName', lastname);\n      this.previousLastname = lastname;\n    }\n  }\n  \n  previousFirstname: string = '';\n  previousLastname: string = '';\n  \n  sendTransliteratedName(field: string, value: string) {\n    const apiUrl = 'http://localhost:5000/transliterate';\n    const data = {\n      [field === 'firstName'? 'firstName' : 'lastName']: value\n    };\n  \n    this.http.post(apiUrl, data, { headers: { 'Content-Type': 'application/json' } })\n     .subscribe(response => {\n        const transliteratedName = field === 'firstName'? (response as any)['الاسم'] : (response as any)['اللقب'];\n        console.log(`${field} translittéré : ${transliteratedName}`);\n  \n        // Envoyer le résultat au serveur Python\n        const sendData = {\n          [field === 'firstName'? 'الاسم' : 'اللقب']: transliteratedName\n        };\n\n        \n        this.http.post('http://localhost:5003/transliterate-names', sendData, { headers: { 'Content-Type': 'application/json' } })\n         .subscribe(sendResponse => {\n            console.log(`${field} envoyé au serveur Python avec succès`);\n          }, sendError => {\n            console.error(`Erreur lors de l'envoi de ${field} au serveur Python :`, sendError);\n          });\n\n\n      }, error => {\n        console.error(`Erreur lors de la translittération de ${field} :`, error);\n      });\n  }\n  \n\n  transliterateFirstName(): void {\n    if (this.user.firstName.trim()!== '') {\n      const apiUrl = 'http://localhost:5000/transliterate';\n      const data = {\n        firstName: this.user.firstName\n      };\n  \n      this.http.post(apiUrl, data, { headers: { 'Content-Type': 'application/json' } })\n        .subscribe(response => {\n          console.log(`Prénom translittéré : ${(response as any)['الاسم']}`);\n          // Traitement supplémentaire si nécessaire\n        }, error => {\n          console.error('Erreur lors de la translittération du prénom :', error);\n        });\n    }\n  }\n  \n  transliterateLastName(): void {\n    if (this.user.lastName.trim()!== '') {\n      const apiUrl = 'http://localhost:5000/transliterate';\n      const data = {\n        lastName: this.user.lastName\n      };\n  \n      this.http.post(apiUrl, data, { headers: { 'Content-Type': 'application/json' } })\n        .subscribe(response => {\nconsole.log(`Nom translittéré : ${(response as any)['اللقب']}`);\n          // Traitement supplémentaire si nécessaire\n        }, error => {\n          console.error('Erreur lors de la translittération du nom :', error);\n        });\n    }\n  }\n  \n  \n\n  async onSubmit() {\n    if (this.isSubmitting) return;\n    this.isSubmitting = true;\n\n    // Validation des champs obligatoires\n    if (!this.validateForm()) {\n        alert(\"Veuillez remplir tous les champs du formulaire.\");\n        this.isSubmitting = false;\n        return;\n    }\n\n    const birthdate = new Date(this.user.dob);\n    const today = new Date();\n    if (birthdate.getFullYear() > today.getFullYear()) {\n        alert(\"Choix incorrect : l'année choisie ne peut pas être supérieure à l'année actuelle.\");\n        this.isSubmitting = false;\n        return;\n    }\n    const age = today.getFullYear() - birthdate.getFullYear();\n    const monthDiff = today.getMonth() - birthdate.getMonth();\n    if (age < 18 || (age === 18 && monthDiff < 0)) {\n        alert(\"Vous devez avoir au moins 18 ans.\");\n        this.isSubmitting = false;\n        return;\n    }\n\n    try {\n        // Appel à la nouvelle route pour récupérer le statut de la comparaison\n        const comparisonResultResponse = await this.http.get<any>(\n            'http://localhost:5003/get-comparison-result'\n        ).toPromise();\n\n        // Afficher le statut de la comparaison dans la console\n        console.log(\"Statut de la comparaison ######## :\", comparisonResultResponse.statut);\n\n        // Vérifiez le statut avant d'envoyer les données utilisateur\n        if (comparisonResultResponse.statut === \"ok\") {\n            const userData = {\n                firstName: this.user.firstName,\n                lastName: this.user.lastName,\n                country: this.user.country,\n                city: this.user.city,\n                dob: this.formatDate(this.user.dob),\n                dobArabic: this.user.dobArabic,\n                gender: this.user.gender,\n                idCardFront: this.user.idCardFront,\n                idCardBack: this.user.idCardBack,\n                extractedDataFront: this.user.extractedDataFront,\n                extractedDataBack: this.user.extractedDataBack,\n                selfie: this.user.selfie,\n                comparisonStatus: comparisonResultResponse.statut\n            };\n\n            // Envoi des données à l'API utilisateur\n            this.http.post('http://localhost:5000/api/users', userData)\n                .subscribe(\n                    (response) => {\n                        console.log('Utilisateur ajouté:', response);\n                        this.resetForm();\n                    },\n                    (error) => {\n                        console.error('Erreur lors de l\\'ajout:', error);\n                        alert('Erreur lors de l\\'enregistrement: ' + error.error.message);\n                    }\n                ).add(() => {\n                    this.isSubmitting = false;\n                });\n        } else {\n            alert(\"La comparaison a échoué : \" + (comparisonResultResponse.message || \"Erreur inconnue\"));\n            this.isSubmitting = false;\n            this.resetForm();\n        }\n    } catch (error) {\n        console.error(\"Erreur lors de la récupération du statut de la comparaison:\", error);\n        alert(\"Une erreur est survenue lors de la communication avec le serveur.\");\n        this.isSubmitting = false;\n    }\n}\n\nresetForm() {\n    this.user = {\n        firstName: '',\n        lastName: '',\n        country: '',\n        city: '',\n        dob: '',\n        dobArabic: '', // Ajoutez cette ligne\n        gender: '',\n        genderArabic:'',\n        idCardFront: '',\n        idCardBack: '',\n        extractedDataFront: {},\n        extractedDataBack: {},\n        selfie: null\n    };\n\n    const fileInputs = document.querySelectorAll('input[type=\"file\"]') as NodeListOf<HTMLInputElement>;\n    fileInputs.forEach(input => input.value = '');\n\n    const selfiePreview = document.getElementById('selfiePreview') as HTMLImageElement;\n    if (selfiePreview) {\n        selfiePreview.src = '';\n    }\n\n    this.startCamera();\n}\n \n  /*\n  checkFocusOut(event: FocusEvent) {\n    const firstname = (event.target as HTMLInputElement).value.trim();\n    if (firstname !== '') {\n      this.http.post('http://localhost:5000/transliterate', { text: firstname })\n        .subscribe({\n          next: (data: any) => console.log('Texte en arabe :', data.arabic),\n          error: err => console.error('Erreur lors de la translittération:', err)\n        });\n    }\n  }*/\n  \n  \n  formatDate(date: string): string {\n    const d = new Date(date);\n    const day = String(d.getDate()).padStart(2, '0');\n    const month = String(d.getMonth() + 1).padStart(2, '0');\n    const year = d.getFullYear();\n    return `${day}/${month}/${year}`;\n  }\n}","<!DOCTYPE html>\n<html lang=\"fr\">\n\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Formulaire Financier</title>\n    <link href=\"https://fonts.googleapis.com/css2?family=Caveat:wght@400;600&display=swap\" rel=\"stylesheet\">\n</head>\n\n<body>\n    <h2>Ouvrez votre avenir financier avec nous !</h2>\n\n    <form (ngSubmit)=\"onSubmit()\" #form=\"ngForm\">\n        <div>\n            <label for=\"firstname\">Nom</label>\n            <input\n            type=\"text\"\n            id=\"firstName\"\n            name=\"firstName\"\n            [(ngModel)]=\"user.firstName\"\n            (ngModelChange)=\"transliterateFirstName()\"\n            (blur)=\"checkFocusOutFirstName($event)\"\n            required\n            />\n        </div>\n        <div>\n            <label for=\"lastname\">Prénom</label>\n            <input\n            type=\"text\"\n            id=\"lastName\"\n            name=\"lastName\"\n            [(ngModel)]=\"user.lastName\"\n            (ngModelChange)=\"transliterateLastName()\"\n            (blur)=\"checkFocusOutLastName($event)\"\n            required\n            />\n        </div>\n        \n\n        <div>\n            <label for=\"country\">Pays</label>\n            <select [(ngModel)]=\"user.country\" name=\"country\" required #country=\"ngModel\" (change)=\"onCountryChange()\">\n              <option *ngFor=\"let country of countries\" [value]=\"country\">{{ country }}</option>\n            </select>\n        </div>\n    \n\n        <!-- Sélection de la ville -->\n        <div>\n            <label for=\"city\">Ville</label>\n            <select [(ngModel)]=\"user.city\" name=\"city\" required #city=\"ngModel\">\n                <option *ngFor=\"let city of cities\" [value]=\"city\">{{ city }}</option>\n            </select>\n        </div>\n\n        <div>\n            <label for=\"dob\">Date de naissance</label>\n            <input type=\"date\" [(ngModel)]=\"user.dob\" name=\"dob\" required #dob=\"ngModel\" (change)=\"onDateChange()\">\n            <div *ngIf=\"ageError\" style=\"color: red;\">{{ ageError }}</div>\n            <div *ngIf=\"dateError\" style=\"color: red;\">{{ dateError }}</div>\n        </div>\n        <div>\n            <label for=\"selfie\">Vérification de vivacité:</label>\n            <button (click)=\"startLivenessDetection()\">Commencer la vérification</button>\n            <div *ngIf=\"user.selfie\">\n                <strong>Selfie vérifiée:</strong>\n                <img [src]=\"user.selfie\" style=\"max-width: 200px;\" />\n            </div>\n        </div>\n\n        <div>\n            <label for=\"selfie\">Insérer le recto de votre pièce d'identité:</label>\n            <input type=\"file\" (change)=\"onFileChangeRecto($event, UserFields.IdCardFront)\" />\n            <div *ngIf=\"user.extractedDataFront\">\n                <strong>Résultats extractés (Recto) :</strong>\n                <pre>{{ user.extractedDataFront | json }}</pre>\n            </div>\n        </div>\n        \n        <div>\n            <label for=\"selfie\">Insérer le verso de votre pièce d'identité:</label>\n            <input type=\"file\" (change)=\"onFileChangeVerso($event, UserFields.IdCardBack)\" />\n            <div *ngIf=\"user.extractedDataBack\">\n                <strong>Résultats extractés (Verso) :</strong>\n                <pre>{{ user.extractedDataBack | json }}</pre>\n            </div>\n        </div>\n        \n\n        <div>\n            <label for=\"gender\">Genre</label>\n            <select [(ngModel)]=\"user.gender\" name=\"gender\" required #gender=\"ngModel\" (change)=\"onGenderChange(user.gender)\">\n                <option value=\"\" disabled selected>Choisissez un genre</option>\n                <option value=\"male\">Male</option>\n                <option value=\"female\">Female</option>\n            </select>\n        </div>\n        \n        <button (click)=\"onSubmit()\">Submit</button>\n    </form>\n</body>\n</html>\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}